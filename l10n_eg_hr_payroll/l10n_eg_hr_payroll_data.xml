<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- CONTRIBUTION REGISTERS -->
        <!-- <record id="res_partner_onss" model="res.partner">
             <field name="name">Office National de Sécurité Sociale (ONSS)</field>
             <field name="supplier">1</field>
             <field eval="0" name="customer"/>
         </record>
         <record id="contrib_register_onss" model="hr.contribution.register">
             <field name="name">ONSS</field>
             <field name="note">National Office of Social Security</field>
             <field name="partner_id" ref="res_partner_onss"/>
         </record>
         <record id="res_partner_pp" model="res.partner">
             <field name="name">Fiscal Administration</field>
             <field name="supplier">1</field>
             <field eval="0" name="customer"/>
         </record>
         <record id="contrib_register_pp" model="hr.contribution.register">
             <field name="name">Fiscal Administration</field>
             <field name="partner_id" ref="res_partner_pp"/>
         </record>
         <record id="res_partner_meal_vouchers" model="res.partner">
             <field name="name">Meal Voucher Supplier</field>
             <field name="supplier">1</field>
             <field eval="0" name="customer"/>
         </record>
         <record id="contrib_register_meal_vouchers" model="hr.contribution.register">
             <field name="name">Meal Voucher Supplier</field>
             <field name="partner_id" ref="res_partner_meal_vouchers"/>
         </record>-->

        <!-- HR SALARY RULE CATEGORIES-->
        <record id="hr_payroll_tax" model="hr.salary.rule.category">
            <field name="name">Taxes</field>
            <field name="code">TAX</field>
            <field name="parent_id" ref="hr_payroll.DED"/>
        </record>
        <record id="hr_payroll_insurance" model="hr.salary.rule.category">
            <field name="name">Social Insurance</field>
            <field name="code">INS</field>
            <!--<field name="parent_id" ref="hr_payroll.DED"/>-->
        </record>
        <record id="hr_payroll_taxable" model="hr.salary.rule.category">
            <field name="name">Taxable</field>
            <field name="code">TXBL</field>
            <!--<field name="parent_id" ref="hr_payroll.DED"/>-->
        </record>
        <record id="hr_payroll_exemption" model="hr.salary.rule.category">
            <field name="name">Exemptions</field>
            <field name="code">EXMPT</field>
            <!--<field name="parent_id" ref="hr_payroll.DED"/>-->
        </record>

        <!-- BASIC: 1, GROSS: 100, NET: 200 -->

        <!-- HR SALARY RULES-->
        <!-- Allowances -->
        <record id="hr_payroll_transportation_alw" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Transportation allowances</field>
            <field name="code">TRANSPORT</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.transportation_amount > 0.0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.transportation_amount</field>
        </record>
        <record id="hr_payroll_meal_alw" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Meal allowances</field>
            <field name="code">MEAL</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.meal_amount > 0.0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.meal_amount</field>
        </record>
        <record id="hr_payroll_mobile_alw" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Mobile allowances</field>
            <field name="code">MOBILE</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.mobile_amount > 0.0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.mobile_amount</field>
        </record>
        <record id="hr_payroll_commission_alw" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Commission allowances</field>
            <field name="code">COMMISSION</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.commission_amount > 0.0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.commission_amount</field>
        </record>
        <record id="hr_payroll_other_taxable_alw" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Other Taxable allowances</field>
            <field name="code">TAXABLE</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.other_taxable_amount > 0.0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.other_taxable_amount</field>
        </record>
        <record id="hr_payroll_non_taxable_alw" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="name">Non Taxable allowances</field>
            <field name="code">NONTAXABLE</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.non_taxable_amount > 0.0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.non_taxable_amount</field>

        </record>


        <!-- Social Insurance rules -->
        <record id="hr_payroll_rules_insurance_basic_rule" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_insurance"/>
            <field name="name">Social Insurance Basic</field>
            <field name="code">INS_BASIC</field>
            <field name="sequence">41</field>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 1120 if contract.wage > 1120 else contract.wage</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
        <record id="hr_payroll_rules_insurance_variable_rule" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_insurance"/>
            <field name="name">Social Insurance variable</field>
            <field name="code">INS_VAR</field>
            <field name="sequence">42</field>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 2110 if contract.variable_amount + (contract.wage - INS_BASIC) >= 2110 else (contract.variable_amount + (contract.wage - INS_BASIC))</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
<record id="hr_payroll_rules_insurance_total_rule" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll.DED"/>
            <field name="name">Social Insurance</field>
            <field name="code">INS_TOTAL</field>
            <field name="sequence">43</field>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result =  INS_BASIC * 0.14 + INS_VAR * 0.11</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>

        <!-- Total Exemption -->
        <record id="hr_payroll_rules_exemptions" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_exemption"/>
            <field name="name">Total exemptions</field>
            <field name="code">EXEMPTIONS</field>
            <field name="sequence">60</field>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.social_allowance_amount + contract.non_taxable_amount + contract.mobile_amount * 0.8 + INS_TOTAL + 1125</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>

        <record id="hr_payroll_rules_taxable_amount" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_taxable"/>
            <field name="name">Taxable amount</field>
            <field name="code">TAXABLE</field>
            <field name="sequence">120</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = categories.GROSS - categories.EXMPT</field>
            <field name="condition_select">none</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>

        <record id="hr_payroll_rules_tax" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_tax"/>
            <field name="name">Tax</field>
            <field name="code">TAX</field>
            <field name="amount_select">fix</field>
            <field name="amount_fix">0.0</field>
            <field name="sequence">140</field>
            <field name="condition_select">none</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
        <record id="hr_payroll_rules_taxes_1958" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_tax"/>
            <field name="parent_rule_id" ref="hr_payroll_rules_tax"/>
            <field name="name">Tax 1958</field>
            <field name="code">TAX_1958</field>
            <field name="amount_select">percentage</field>
            <field name="amount_percentage_base">categories.TXBL</field>
            <field name="amount_percentage">-1</field>
            <field name="sequence">141</field>
            <field name="condition_select">range</field>
            <field name="condition_range">categories.TXBL</field>
            <field name="condition_range_min">0.0</field>
            <field name="condition_range_max">1958.335</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
        <record id="hr_payroll_rules_taxes_3208" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_tax"/>
            <field name="parent_rule_id" ref="hr_payroll_rules_tax"/>
            <field name="name">Tax 3208</field>
            <field name="code">TAX_3208</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 1958.335*0.1+(categories.TXBL-1958.335)*0.15</field>
            <field name="sequence">142</field>
            <field name="condition_select">range</field>
            <field name="condition_range">categories.TXBL</field>
            <field name="condition_range_min">1958.335</field>
            <field name="condition_range_max">3208.335</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
        <record id="hr_payroll_rules_taxes_16125" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_tax"/>
            <field name="parent_rule_id" ref="hr_payroll_rules_tax"/>
            <field name="name">Tax 16125</field>
            <field name="code">TAX_16125</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 1958.335*0.1+1250*0.15+(categories.TXBL-3208.335)*0.2</field>
            <field name="sequence">143</field>
            <field name="condition_select">range</field>
            <field name="condition_range">categories.TXBL</field>
            <field name="condition_range_min">3208.335</field>
            <field name="condition_range_max">16125</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
        <record id="hr_payroll_rules_taxes_16125_" model="hr.salary.rule">
            <field name="category_id" ref="hr_payroll_tax"/>
            <field name="parent_rule_id" ref="hr_payroll_rules_tax"/>
            <field name="name">Tax 16125+</field>
            <field name="code">TAX_16125+</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 1958.335*0.1+1250*0.15+12916.665*0.2+(categories.TXBL-16125)*0.225</field>
            <field name="sequence">144</field>
            <field name="condition_select">python</field>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_python">result = categories.TXBL > 16125</field>
            <field name="appears_on_payslip" eval="False"/>
        </record>
        <record id="hr_payroll_salary_structure_legal_employee" model="hr.payroll.structure">
            <field name="code">EGP.201508</field>
            <field name="name">Egypt Legal rules. 201508</field>
            <field eval="[(6, 0, [ref('hr_payroll_rules_tax'),ref('hr_payroll_rules_exemptions'),
            ref('hr_payroll_rules_taxable_amount'),ref('hr_payroll_rules_insurance_basic_rule'),ref('hr_payroll_rules_insurance_variable_rule'),ref('hr_payroll_transportation_alw'),
            ref('hr_payroll_meal_alw'),ref('hr_payroll_mobile_alw'),
            ref('hr_payroll_commission_alw'),ref('hr_payroll_other_taxable_alw'),ref('hr_payroll_non_taxable_alw'),ref('hr_payroll_rules_insurance_total_rule'),])]"
                   name="rule_ids"/>
            <field name="company_id" ref="base.main_company"/>
            <field name="parent_id" ref="hr_payroll.structure_base"/>
        </record>
    </data>
</openerp>
